{PE.DataSource id="cone" datasource="软件_内容页" itemid="@RequestInt_id" xslt="true" /}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="UTF-8">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta content="{PE.Field id="cone" fieldname="SoftIntro" /}" name="Description" />
<meta content="{PE.Field id="cone" fieldname="KeyWord" /}" name="Keywords" />
<title>{PE.Field id="cone" fieldname="Title" /} - {PE.SiteConfig.sitename /}</title>
<link href="{PE.SiteConfig.ApplicationPath /}Skin/Gray/default.css" rel="stylesheet" type="text/css" />
<link href="{PE.SiteConfig.ApplicationPath /}Skin/Gray/soft.css" rel="stylesheet" type="text/css" />
<link href="{PE.SiteConfig.ApplicationPath /}Skin/Gray/commentary.css" rel="stylesheet" type="text/css" />
<link href="{PE.SiteConfig.ApplicationPath /}Skin/Gray/user.css" rel="stylesheet"type="text/css" />
<script language="javascript" type="text/javascript" src="{PE.SiteConfig.ApplicationPath /}js/common.js"></script>
<script language="javascript" type="text/javascript" src="{PE.SiteConfig.ApplicationPath/}JS/jsPopup.js"></script>
</head>
<body onload="commentinit()">
{PE.label id="雅灰网站顶部" /}
<!-- 中部网站导航 -->
<table class="center_all" cellspacing="0">
    <tr>
        <td><table id="r_navigation" cellspacing="0">
                <tr>
                    <td class="r_n_pic"></td>
                    <td class="logo_nav">您现在的位置：<a href="{PE.SiteConfig.sitepath/}">{PE.SiteConfig.sitename /}</a>{PE.Label id="内容位置导航" itemid="@RequestInt_id" /}</td>
                    <td id="top_link"><ul>
                            <li>
                                <marquee onmouseover="this.stop()" onmouseout="this.start()" scrollamount="1" scrolldelay="4" align="left">
                                {PE.Label id="雅灰网站公告横向" /}
                                </marquee>
                            </li>
                        </ul></td>
                </tr>
            </table></td>
    </tr>
</table>
<table class="center_all" cellspacing="0">
    <tr>
        <td><table class="main" cellspacing="0">
                <tr>
                    <td class="main_left"><table class="width_100" cellspacing="0">
                            <tr>
                                <td class="width_l"><table class="c_shop" cellspacing="0">
                                        <tr>
                                            <td><table class="cshop_tit">
                                                    <tr>
                                                        <td><span class="showicon">相关软件</span></td>
                                                    </tr>
                                                </table></td>
                                        </tr>
                                        <tr>
                                            <td class="c_content">{PE.Label id="相关内容" shownum="10" titlelen="20" showupdatetime="false" showpic="false" shownodename="false" target="_blank" node_target="_blank" span_classname="new" keyword="{PE.Label id="取得关键字" itemid="@RequestInt_id" tablename="PE_U_Soft" /}" tablename="PE_U_Soft" generalid="@RequestInt_id" /}</td>
                                        </tr>
                                    </table>
                                    <table class="c_shop" cellspacing="0">
                                        <tr>
                                            <td><table class="cshop_tit" cellspacing="0">
                                                    <tr>
                                                        <td><span class="showicon">作者相关软件</span></td>
                                                    </tr>
                                                </table></td>
                                        </tr>
                                        <tr>
                                            <td class="c_content">{PE.Label id="作者相关内容" shownum="10" showupdatetime="false" target="_blank" titlelen="40" author="{PE.Label id="取得作者名" itemid="@RequestInt_id" tablename="PE_U_Soft" /}" tablename="PE_U_Soft" generalid="@RequestInt_id" showpic="false" shownodename="false" span_classname="new" /} </td>
                                        </tr>
                                    </table>
                                    <!-- 左边栏目结束 -->
                                </td>
                                <td class="width_5"></td>
                                <td>
                                	<table id="s_info" cellspacing="0">
                                    	<tr>
                                        	<td colspan="3" class="s_info_title">
                                            	{PE.Field id="cone" fieldname="Title" /}
                                            </td>
                                        </tr>
                                        <tr class="s_info_content">
                                        	<td class="s_info_content_l">
                <ul>
                  <li>软件大小：<span class="s_font_weight"> {PE.Field id="cone" fieldname="SoftSize" /} {PE.Field id="cone" fieldname="SoftSizeUnit" /}</span> </li>
                 <li>浏览次数：<span class="s_font_weight"> {PE.Field id="cone" fieldname="BrowseTimes" /} </span> </li>
                  <li>软件版本：<span class="s_font_weight"> {PE.Field id="cone" fieldname="SoftVersion" /} </span> </li>
                  <li>软件语言：<span class="s_font_weight"> {PE.Field id="cone" fieldname="SoftLanguage" /} </span> </li>
                  <li>软件评级：<span class="s_font_green"> {PE.Field id="cone" fieldname="Stars" /} </span> </li>
                  <li>开 发 商：<span class="s_font_blue"> {PE.Field id="cone" fieldname="Author" /} </span> </li>
                  <li>软件来源：<span class="s_font_weight"> {PE.Field id="cone" fieldname="CopyFrom" /} </span> </li>
				   <li>本日下载数：<span class="s_font_red"> {PE.Field id="cone" fieldname="DayDownLoadTimes" /} </span> </li>
				   
                  <li>本月下载数：<span class="s_font_weight"> {PE.Field id="cone" fieldname="MonthDownLoadTimes" /} </span> </li>
				 
                </ul>
                                            </td>
                                        	<td class="s_info_content_c">
                <ul>
                  <li>软件类别：<span class="s_font_weight"> {PE.Field id="cone" fieldname="SoftType" /} </span> </li>
                  <li>软件授权：<span class="s_font_red"> {PE.Field id="cone" fieldname="CopyrightType" /} </span> </li>
                  <li>解压密码：<span class="s_font_weight"> {PE.Field id="cone" fieldname="DecompressPassword" /} </span> </li>
                  <li>运行平台：<span class="s_font_weight"> {PE.Field id="cone" fieldname="OperatingSystem" /} </span> </li>
                  <li>更新时间：<span class="s_font_weight"> {PE.Field id="cone" fieldname="UpdateTime" /} </span> </li>
                  <li>注册地址：<span class="s_font_weight"> <a href="{PE.Field id="cone" fieldname="RegUrl" /}" target="_blank">{PE.Field id="cone" fieldname="RegUrl" /}</a> </span> </li>
                  <li>演示地址：<span class="s_font_weight"> <a href="{PE.Field id="cone" fieldname="DemoUrl" /}" target="_blank">{PE.Field id="cone" fieldname="DemoUrl" /}</a> </span> </li>
                   <li>本周下载数：<span class="s_font_weight"> {PE.Field id="cone" fieldname="WeekDownLoadTimes" /} </span> </li>
                  
                </ul>
                                            </td>
                                        	<td class="s_info_content_r">
                <div class="s_font_PicUrl"><a href="{PE.Field id="cone" fieldname="DefaultPicUrl" /}" target="_blank"><img src="{PE.Field id="cone" fieldname="DefaultPicUrl" /}" alt="{PE.Field id="cone" fieldname="Title" /}" border="0" /></a>  </div>
                <div class="s_font_collection"> <a href="{PE.SiteConfig.ApplicationPath/}User/Contents/Favorite.aspx?Action=add&Id={PE.Field id="cone" fieldname="GeneralID" /}">收藏</a>　　<a href="{PE.SiteConfig.applicationpath/}Common/ShowDownloadError.aspx?id={PE.Field id="cone" fieldname="GeneralID" /}&type=1">报错</a>　 </div>
              </div>
                                           </td>
                                        </tr>
                                	</table>
                                </td>
                            </tr>
                        </table>
                        <!-- 软件介绍开始 -->
                        <table class="c_main" cellspacing="0">
                            <tr>
                                <td><table class="cmain_tit">
                                        <tr>
                                            <td><span class="showicon">软件介绍</span></td>
                                        </tr>
                                    </table></td>
                            </tr>
                            <tr>
                                <td class="c_content">{PE.Field id="cone" fieldname="SoftIntro"  /}
                                </td>
                            </tr>
                        </table>
                        <!-- 软件介绍结束 -->
                        <!-- 下载地址开始 -->
                        <table class="c_main" cellspacing="0">
                            <tr>
                                <td><table class="cmain_tit">
                                        <tr>
                                            <td><span class="showicon">下载地址</span></td>
                                        </tr>
                                    </table></td>
                            </tr>
                            <tr>
                                <td class="c_content">
                                    <!-- 左侧下载地址 -->
                                    {PE.DataSource id="downcone" datasource="显示下载地址" generalid="@RequestInt_id" xslt="true" /}
                                    <div class="S_DownloadUrl">
                                    {PE.Charge}
                                        <dl>
                                            <dt>本站下载</dt>
                                            <dd>{PE.Field id="downcone" fieldname="LocalServer" /}</dd>
                                            <dt>镜像服务器下载</dt>
                                            <dd> {PE.Field id="downcone" fieldname="MirrorServer" /} </dd>
                                        </dl>
                                    {/PE.Charge}
                                    </div>
                                	{PE.Label id="右侧广告(2)" /}
                                </td>
                            </tr>
                        </table>
                        <!-- 下载地址结束 -->
                        <table class="s_notice" cellspacing="0">
                            <tr>
                                <td> <ul>
                                        <li>为了达到最快的下载速度，推荐使用 <a href="http://www.flashget.com/" target="_blank">FlashGet</a> 和 <a href="http://www.xunlei.com/" target="_blank">迅雷</a> 下载本站软件。</li>
                                        <li>如果这个软件总是不能下载，请点击 <a href="{PE.SiteConfig.applicationpath/}Common/ShowDownloadError.aspx?id={PE.Field id="cone" fieldname="GeneralID" /}&type=1"> 报告错误</a> ，欢迎广大作者给我们 <a href="{PE.SiteConfig.applicationpath/}User/Contents/AnonymousContent.aspx" target="_blank">提供软件</a>，在此感谢您的支持与合作！</li>
                                        <li><span class="s_font_red">未经本站明确许可，任何网站不得非法盗链软件下载连接及抄袭本站原创内容资源!</span></li>
                                      </ul>
                                    <div class="clearbox"></div>
                                    <!-- 下载说明结束 -->
                                </td>
                            </tr>
                        </table>
                        <div class="c_main_box" style ="text-align:right;">
                            <span >【<a href="{PE.SiteConfig.applicationpath/}ShowComment.aspx?id={PE.Field id="cone" fieldname="GeneralID" /}">查看评论</a>】</span>
                        </div> 
                         <span id="commentform"></span> </td>
                    <td width="5"></td>
                    <td class="main_right" valign="top"> {PE.Label id="雅灰下载内容右侧" /} </td>
                </tr>
            </table>
            <!-- main 结束 -->
        </td>
    </tr>
</table>
<!-- center_all 结束 -->
{PE.Label id=" 雅灰网站底部" /}
<!-- 评论变量区 -->
<input id="username" type="hidden" value="游客" />
<input id="position" type="hidden" value="1" />
<input id="private" type="hidden" value="0" />
<input id="score" type="hidden" value="3" />
<input id="face" type="hidden" value="Images\Comment\01.gif" />
<input id="gid" type="hidden" value="@RequestInt_id" />
<input id="nid" type="hidden" value="{PE.Field id="cone" fieldname="NodeID" /}" />
<input id="tid" type="hidden" value="1" />
<!-- 评论变量区 -->
<script language="javascript" type="text/javascript">
function redirecturl(url, tarid)
{
    location=url.replace(/{\$pageid\/}/g,tarid);
}

//评论相关代码
function commentinit()
{
    var x = new AjaxRequest('XML','commentform');
    x.labelname = "内容评论PK标签";
    x.para = ['generalid=@RequestInt_id'];
    x.currentpage = 1;
    x.post('updatelabel', '{PE.SiteConfig.applicationpath/}ajax.aspx', function(s) {
        var xml = x.createXmlDom(s);
        $("commentform").innerHTML = xml.getElementsByTagName("body")[0].firstChild.data;
        changepage(1,'评论列表','JS_基本风格');
        getcurrentuserinfo()
    });
}

function SetPosition(st)
{
     for (i=-1;i<2;i++){
          if(i == st){
              $("Positon" + i).className="PK_mouseover";
          }
          else{
              $("Positon" + i).className="PK_title";
          }
     }
     $("position").value = st;
}

function addcomment()
{
    if(!$("guest").checked)
    {
        var strEmail = $("email").value;
	    var regEmail = /^([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;
	    var matchArray = strEmail.match(regEmail);
    		
	    if(matchArray == null)
	    {
            alert("请输入正确的Email格式！");
            $("email").focus();
            return false; 
	    }
	    
        if($("iusername").value == '')
        {
            alert("请输入用户名");
            $("iusername").focus();
            return false;           
        }
        else
        {
            $("username").value = $("iusername").value;
        }
    }
//    if($("commenttitle").value == '')
//    {
//        alert("请输入标题");
//        $("commenttitle").focus();
//        return false; 
//    }
    if($("content").value == '')
    {
        alert("请输入评论内容");
        $("content").focus();
        return false;                
    }
    var x = new AjaxRequest('XML','status');
    x.para = ['username', 'commenttitle', 'content', 'email', 'face', 'gid', 'nid', 'tid', 'private', 'position', 'score'];
    x.post('addcomment', '{PE.SiteConfig.applicationpath/}ajax.aspx', function(s) {
        var xml = x.createXmlDom(s);
        var  status = xml.getElementsByTagName("status")[0].firstChild.data;
        document.getElementById("status").style.display = "none";
        switch (status)
        {
            case "ok":
                changepage(1,'评论列表','JS_基本风格');
                break;
            case "check":
                alert("发表评论成功，请等待管理员审核。");  
                break;
            case "err":
                alert("发表评论失败！");  
                break;
            case "nopurview":
                alert("此栏目已禁止发表评论！");  
                break;
            case "noTourists":
                alert("此栏目已禁止游客发表评论！");  
                break;                    
            default:
                alert("发表评论失败！"); 
                break;
        }
        $("content").value = '';
    });
}

function addpkzone(commentid,position,content)
{
    var x = new AjaxRequest('XML','status');
    x.para = ['commentid='+ commentid, 'position=' + position, 'content=' + content];
    x.post('addpkzone', '{PE.SiteConfig.applicationpath/}ajax.aspx', function(s) {
        var xml = x.createXmlDom(s);
        var  status = xml.getElementsByTagName("status")[0].firstChild.data;
        document.getElementById("status").style.display = "none";
        switch (status)
        {
            case "ok":
                changepage(1,'评论列表','JS_基本风格');
                break;                  
            default:
                alert("辩论失败！"); 
                break;
        }
    });
}

function changepage(pagenum,sourcename,spanname)
{
    var x = new AjaxRequest('XML','pe100_' + sourcename);
    x.labelname = sourcename;
    x.currentpage = pagenum; 
	x.para = ['gid=@RequestInt_id', 'listnum=10', 'page=true', 'pagesize=10'];
	x.post('updatelabel', '{PE.SiteConfig.applicationpath/}ajax.aspx', function(s) {
        var xml = x.createXmlDom(s);
        var plstr = "";
        for (var i=0; i<xml.getElementsByTagName("body")[0].childNodes.length; i++)     
        {
            plstr += xml.getElementsByTagName("body")[0].childNodes[i].nodeValue;
        }
        $("pe100_" + sourcename).innerHTML = plstr;
        updatepage(spanname, sourcename, xml);
    });
}

function updatepage(spanname, sourcename, xml)
{
    if(parseInt(xml.getElementsByTagName("total")[0].firstChild.data) > 0)
    {
        var x = new AjaxRequest('XML','pe100_page_' + sourcename);
        x.labelname = spanname;
        x.sourcename = sourcename;
        x.total = xml.getElementsByTagName("total")[0].firstChild.data;
        x.currentpage = xml.getElementsByTagName("currentpage")[0].firstChild.data;
        x.pagesize = xml.getElementsByTagName("pagesize")[0].firstChild.data;
	    x.post('updatepage', '{PE.SiteConfig.applicationpath/}ajax.aspx', function(s) {
            var xml = x.createXmlDom(s);
            if($("pe100_page_" + sourcename) != null)
            {
                var plstr = "";
                for (var i=0; i<xml.getElementsByTagName("body")[0].childNodes.length; i++)     
                {
                    plstr += xml.getElementsByTagName("body")[0].childNodes[i].nodeValue;
                }
                $("pe100_page_" + sourcename).innerHTML = plstr;
            }
	});
    }
}

function setprivate()
{
    if($("open").checked)
    {
        $("private").value = 0;
    }
    else
    {
        $("private").value = 1;
    }
}
 
function getcurrentuserinfo()
{ 
    try{
        var x = new AjaxRequest('XML','');
	x.post('logincheck','{PE.SiteConfig.applicationpath/}ajax.aspx', function(s) {
            var xml = x.createXmlDom(s);
            if(xml.getElementsByTagName("status")[0].firstChild.data == "ok")
            {
                if($("iusername")!=null)
                {
                    $("iusername").value = xml.getElementsByTagName("username")[0].firstChild.data;
                    $("email").value = xml.getElementsByTagName("email")[0].firstChild.data;
                }
            }
        });
      }
      catch(e){
      };
}

function setguest()
{
    if($("guest").checked)
    {
        $("spanusername").style.display = 'none';
        $("spanemail").style.display = 'none';
    }
    else
    {
        $("spanusername").style.display = '';
        $("spanemail").style.display = '';
    }
}

function ChangeStar(index, isfixed){
     var colStars = document.getElementById("divStars").getElementsByTagName("input");
     var i = 0;
     var k = isfixed? parseInt(document.getElementById("score").value) : index;

     for(i=0; i<colStars.length; i++){
             colStars[i].src = (i<k? "{PE.SiteConfig.applicationpath/}Images/fstar.gif" : "{PE.SiteConfig.applicationpath/}Images/estar.gif");
     }
}

function StarClick(index)
{
    document.getElementById("score").value=index;
}

function StarMouseOver(index){
    ChangeStar(index,false);
}

function StarMouseOut(){
    ChangeStar(0,true);
}
</script>
</body>
</html>
